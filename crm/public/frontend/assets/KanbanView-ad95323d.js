import{m as B,h as T,i as x,r as F,b as r,c as u,g as E,w as c,e as s,d as n,n as I,F as R,f as j,t as h,u as C,G as q,C as z,L as y,M as w,N as L,l as g,p as H}from"./index-9a3d44ca.js";import{a as J}from"./Link-b1fdcf99.js";import{_ as Q}from"./NestedPopover-767b5999.js";import{I as P}from"./IndicatorIcon-8bdc1dd8.js";import{D as A}from"./DragVerticalIcon-21aa16a4.js";import{D as U}from"./Dropdown-d1bc143c.js";const W={class:"flex overflow-x-auto"},X={key:0,class:"flex flex-col gap-2.5 min-w-72 w-72 hover:bg-gray-100 rounded-lg p-2.5"},Y={class:"flex gap-2 items-center group justify-between"},Z={class:"flex items-center text-base"},ee={class:"flex flex-col gap-3 px-3 py-2.5 rounded-lg border border-gray-100 bg-white shadow-xl"},te={class:"flex gap-1"},le={class:"flex flex-row-reverse"},oe={class:"flex"},ae={class:"overflow-y-auto flex flex-col gap-2 h-full"},ne={class:"h-5 flex items-center"},se={key:0},ie={key:1,class:"text-gray-500"},re=s("div",{class:"border-b h-px my-2.5"},null,-1),ce={class:"flex flex-col gap-3.5"},ue={key:0,class:"truncate"},me=s("div",{class:"border-b h-px mt-2.5 mb-2"},null,-1),de={class:"flex gap-2 items-center justify-between"},fe=s("div",null,null,-1),pe={key:0,class:"flex items-center justify-center"},_e={key:1,class:"shrink-0 min-w-64"},Ce={__name:"KanbanView",props:B({options:{type:Object,default:()=>({getRoute:null,onClick:null,onNewClick:null})}},{modelValue:{},modelModifiers:{}}),emits:B(["update","loadMore"],["update:modelValue"]),setup(d,{emit:O}){const $=O,v=T(d,"modelValue"),b=x(()=>{var e,a;return(a=(e=v.value)==null?void 0:e.data)==null?void 0:a.title_field}),f=x(()=>{var o,m;if(!((m=(o=v.value)==null?void 0:o.data)!=null&&m.data)||v.value.data.view_type!="kanban")return[];let e=v.value.data.data;return e.some(t=>{var l;return(l=t.column)==null?void 0:l.color})||e.forEach((t,l)=>{t.column.color=k[l%k.length]}),e}),N=x(()=>f.value.filter(e=>e.column.delete).map(e=>({label:e.column.name,value:e.column.name})));function S(e){return[{group:__("Options"),hideLabel:!0,items:[{label:__("Delete"),icon:"trash-2",onClick:()=>{e.column.delete=!0,p()}}]}]}function G(e){let a=f.value.find(o=>o.column.name==e.value);a.column.delete=!1,p()}function p(e){var i,D,V;let a=(i=e==null?void 0:e.to)==null?void 0:i.dataset.column,o=(D=e==null?void 0:e.from)==null?void 0:D.dataset.column,m=(V=e==null?void 0:e.item)==null?void 0:V.dataset.name,t=[];f.value.forEach(_=>{_.column.order=_.data.map(K=>K.name),_.column.page_length&&delete _.column.page_length,t.push(_.column)});let l={kanban_columns:t};a!=o&&(l={item:m,to:a,kanban_columns:t}),$("update",l)}function M(e,a=!1){let o=`!text-${e}-600`;e=="black"?o="!text-gray-900":["gray","green"].includes(e)&&(o=`!text-${e}-700`);let m=`!bg-${e}-100 hover:!bg-${e}-200 active:!bg-${e}-300`;return[o,a?"":m]}const k=["gray","blue","green","red","pink","orange","amber","yellow","cyan","teal","violet","purple","black"];return(e,a)=>{const o=F("Button"),m=F("FeatherIcon");return r(),u("div",W,[f.value?(r(),E(C(A),{key:0,list:f.value,"item-key":"column",onEnd:p,class:"flex sm:mx-2.5 mx-2 pb-3.5"},{item:c(({element:t})=>[t.column.delete?g("",!0):(r(),u("div",X,[s("div",Y,[s("div",Z,[n(Q,null,{target:c(()=>[n(o,{variant:"ghost",size:"sm",class:"hover:!bg-gray-100"},{default:c(()=>[n(P,{class:I(M(t.column.color,!0))},null,8,["class"])]),_:2},1024)]),body:c(({close:l})=>[s("div",ee,[s("div",te,[(r(),u(R,null,j(k,i=>n(o,{class:I(M(i)),variant:"ghost",key:i,onClick:()=>t.column.color=i},{default:c(()=>[n(P)]),_:2},1032,["class","onClick"])),64))]),s("div",le,[n(o,{variant:"solid",label:e.__("Apply"),onClick:p},null,8,["label"])])])]),_:2},1024),s("div",null,h(t.column.name),1)]),s("div",oe,[n(C(U),{options:S(t)},{default:c(()=>[n(o,{class:"hidden group-hover:flex",icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"]),n(o,{icon:"plus",variant:"ghost",onClick:l=>d.options.onNewClick(t)},null,8,["onClick"])])]),s("div",ae,[n(C(A),{list:t.data,group:"fields","item-key":"name",class:"flex flex-col gap-3.5 flex-1",onEnd:p,"data-column":t.column.name},{item:c(({element:l})=>[(r(),E(q(d.options.getRoute?"router-link":"div"),z({class:"pt-3 px-3.5 pb-2.5 rounded-lg border bg-white text-base flex flex-col","data-name":l.name},{to:d.options.getRoute?d.options.getRoute(l):void 0,onClick:d.options.onClick?()=>d.options.onClick(l):void 0}),{default:c(()=>[y(e.$slots,"title",w(L({fields:l,titleField:b.value,itemName:l.name})),()=>[s("div",ne,[l[b.value]?(r(),u("div",se,h(l[b.value]),1)):(r(),u("div",ie,h(e.__("No Title")),1))])]),re,s("div",ce,[(r(!0),u(R,null,j(t.fields,i=>y(e.$slots,"fields",w(z({key:i},{fields:l,fieldName:i,itemName:l.name})),()=>[l[i]?(r(),u("div",ue,h(l[i]),1)):g("",!0)])),128))]),me,y(e.$slots,"actions",w(L({itemName:l.name})),()=>[s("div",de,[fe,n(o,{icon:"plus",variant:"ghost",onClick:a[0]||(a[0]=H(()=>{},["stop","prevent"]))})])])]),_:2},1040,["data-name"]))]),_:2},1032,["list","data-column"]),t.column.count<t.column.all_count?(r(),u("div",pe,[n(o,{label:e.__("Load More"),onClick:l=>$("loadMore",t.column.name)},null,8,["label","onClick"])])):g("",!0)])]))]),_:3},8,["list"])):g("",!0),N.value.length?(r(),u("div",_e,[n(J,{value:"",options:N.value,onChange:a[1]||(a[1]=t=>G(t))},{target:c(({togglePopover:t})=>[n(o,{class:"w-full mt-2.5 mb-1 mr-5",onClick:l=>t(),label:e.__("Add Column")},{prefix:c(()=>[n(m,{name:"plus",class:"h-4"})]),_:2},1032,["onClick","label"])]),_:1},8,["options"])])):g("",!0)])}}};export{Ce as _};
//# sourceMappingURL=KanbanView-ad95323d.js.map
