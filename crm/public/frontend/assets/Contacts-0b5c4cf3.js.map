{"version":3,"file":"Contacts-0b5c4cf3.js","sources":["../../../../frontend/src/pages/Contacts.vue"],"sourcesContent":["<template>\n  <LayoutHeader>\n    <template #left-header>\n      <Breadcrumbs :items=\"breadcrumbs\" />\n    </template>\n    <template #right-header>\n      <CustomActions\n        v-if=\"contactsListView?.customListActions\"\n        :actions=\"contactsListView.customListActions\"\n      />\n      <Button\n        variant=\"solid\"\n        :label=\"__('Create')\"\n        @click=\"showContactModal = true\"\n      >\n        <template #prefix><FeatherIcon name=\"plus\" class=\"h-4\" /></template>\n      </Button>\n    </template>\n  </LayoutHeader>\n  <ViewControls\n    ref=\"viewControls\"\n    v-model=\"contacts\"\n    v-model:loadMore=\"loadMore\"\n    v-model:resizeColumn=\"triggerResize\"\n    v-model:updatedPageCount=\"updatedPageCount\"\n    doctype=\"Contact\"\n  />\n  <ContactsListView\n    ref=\"contactsListView\"\n    v-if=\"contacts.data && rows.length\"\n    v-model=\"contacts.data.page_length_count\"\n    v-model:list=\"contacts\"\n    :rows=\"rows\"\n    :columns=\"contacts.data.columns\"\n    :options=\"{\n      showTooltip: false,\n      resizeColumn: true,\n      rowCount: contacts.data.row_count,\n      totalCount: contacts.data.total_count,\n    }\"\n    @loadMore=\"() => loadMore++\"\n    @columnWidthUpdated=\"() => triggerResize++\"\n    @updatePageCount=\"(count) => (updatedPageCount = count)\"\n    @applyFilter=\"(data) => viewControls.applyFilter(data)\"\n    @applyLikeFilter=\"(data) => viewControls.applyLikeFilter(data)\"\n    @likeDoc=\"(data) => viewControls.likeDoc(data)\"\n  />\n  <div\n    v-else-if=\"contacts.data\"\n    class=\"flex h-full items-center justify-center\"\n  >\n    <div\n      class=\"flex flex-col items-center gap-3 text-xl font-medium text-gray-500\"\n    >\n      <ContactsIcon class=\"h-10 w-10\" />\n      <span>{{ __('No {0} Found', [__('Contacts')]) }}</span>\n      <Button :label=\"__('Create')\" @click=\"showContactModal = true\">\n        <template #prefix><FeatherIcon name=\"plus\" class=\"h-4\" /></template>\n      </Button>\n    </div>\n  </div>\n  <ContactModal\n    v-model=\"showContactModal\"\n    v-model:quickEntry=\"showQuickEntryModal\"\n    :contact=\"{}\"\n  />\n  <QuickEntryModal\n    v-if=\"showQuickEntryModal\"\n    v-model=\"showQuickEntryModal\"\n    doctype=\"Contact\"\n  />\n</template>\n\n<script setup>\nimport CustomActions from '@/components/CustomActions.vue'\nimport ContactsIcon from '@/components/Icons/ContactsIcon.vue'\nimport LayoutHeader from '@/components/LayoutHeader.vue'\nimport ContactModal from '@/components/Modals/ContactModal.vue'\nimport QuickEntryModal from '@/components/Settings/QuickEntryModal.vue'\nimport ContactsListView from '@/components/ListViews/ContactsListView.vue'\nimport ViewControls from '@/components/ViewControls.vue'\nimport { Breadcrumbs } from 'frappe-ui'\nimport { organizationsStore } from '@/stores/organizations.js'\nimport { dateFormat, dateTooltipFormat, timeAgo } from '@/utils'\nimport { ref, computed } from 'vue'\nimport { useRoute } from 'vue-router'\n\nconst { getOrganization } = organizationsStore()\nconst route = useRoute()\n\nconst showContactModal = ref(false)\nconst showQuickEntryModal = ref(false)\n\nconst currentContact = computed(() => {\n  return contacts.value?.data?.data?.find(\n    (contact) => contact.name === route.params.contactId,\n  )\n})\n\nconst breadcrumbs = computed(() => {\n  let items = [{ label: __('Contacts'), route: { name: 'Contacts' } }]\n  if (!currentContact.value) return items\n  items.push({\n    label: __(currentContact.value.full_name),\n    route: {\n      name: 'Contact',\n      params: { contactId: currentContact.value.name },\n    },\n  })\n  return items\n})\n\nconst contactsListView = ref(null)\n\n// contacts data is loaded in the ViewControls component\nconst contacts = ref({})\nconst loadMore = ref(1)\nconst triggerResize = ref(1)\nconst updatedPageCount = ref(20)\nconst viewControls = ref(null)\n\nconst rows = computed(() => {\n  if (\n    !contacts.value?.data?.data ||\n    !['list', 'group_by'].includes(contacts.value.data.view_type)\n  )\n    return []\n  return contacts.value?.data.data.map((contact) => {\n    let _rows = {}\n    contacts.value?.data.rows.forEach((row) => {\n      _rows[row] = contact[row]\n\n      if (row == 'full_name') {\n        _rows[row] = {\n          label: contact.full_name,\n          image_label: contact.full_name,\n          image: contact.image,\n        }\n      } else if (row == 'company_name') {\n        _rows[row] = {\n          label: contact.company_name,\n          logo: getOrganization(contact.company_name)?.organization_logo,\n        }\n      } else if (['modified', 'creation'].includes(row)) {\n        _rows[row] = {\n          label: dateFormat(contact[row], dateTooltipFormat),\n          timeAgo: __(timeAgo(contact[row])),\n        }\n      }\n    })\n    return _rows\n  })\n})\n</script>\n"],"names":["getOrganization","organizationsStore","route","useRoute","showContactModal","ref","showQuickEntryModal","currentContact","computed","_c","_b","_a","contacts","contact","breadcrumbs","items","contactsListView","loadMore","triggerResize","updatedPageCount","viewControls","rows","_rows","row","dateFormat","dateTooltipFormat","timeAgo"],"mappings":"w2CAuFA,KAAM,CAAE,gBAAAA,CAAiB,EAAGC,EAAoB,EAC1CC,EAAQC,EAAU,EAElBC,EAAmBC,EAAI,EAAK,EAC5BC,EAAsBD,EAAI,EAAK,EAE/BE,EAAiBC,EAAS,IAAM,WACpC,OAAOC,GAAAC,GAAAC,EAAAC,EAAS,QAAT,YAAAD,EAAgB,OAAhB,YAAAD,EAAsB,OAAtB,YAAAD,EAA4B,KAChCI,GAAYA,EAAQ,OAASX,EAAM,OAAO,UAE/C,CAAC,EAEKY,EAAcN,EAAS,IAAM,CACjC,IAAIO,EAAQ,CAAC,CAAE,MAAO,GAAG,UAAU,EAAG,MAAO,CAAE,KAAM,UAAU,EAAI,EACnE,OAAKR,EAAe,OACpBQ,EAAM,KAAK,CACT,MAAO,GAAGR,EAAe,MAAM,SAAS,EACxC,MAAO,CACL,KAAM,UACN,OAAQ,CAAE,UAAWA,EAAe,MAAM,IAAM,CACjD,CACL,CAAG,EACMQ,CACT,CAAC,EAEKC,EAAmBX,EAAI,IAAI,EAG3BO,EAAWP,EAAI,EAAE,EACjBY,EAAWZ,EAAI,CAAC,EAChBa,EAAgBb,EAAI,CAAC,EACrBc,EAAmBd,EAAI,EAAE,EACzBe,EAAef,EAAI,IAAI,EAEvBgB,EAAOb,EAAS,IAAM,WAC1B,MACE,GAACE,GAAAC,EAAAC,EAAS,QAAT,YAAAD,EAAgB,OAAhB,MAAAD,EAAsB,OACvB,CAAC,CAAC,OAAQ,UAAU,EAAE,SAASE,EAAS,MAAM,KAAK,SAAS,EAErD,CAAE,GACJH,EAAAG,EAAS,QAAT,YAAAH,EAAgB,KAAK,KAAK,IAAKI,GAAY,OAChD,IAAIS,EAAQ,CAAE,EACd,OAAAX,EAAAC,EAAS,QAAT,MAAAD,EAAgB,KAAK,KAAK,QAASY,GAAQ,OACzCD,EAAMC,CAAG,EAAIV,EAAQU,CAAG,EAEpBA,GAAO,YACTD,EAAMC,CAAG,EAAI,CACX,MAAOV,EAAQ,UACf,YAAaA,EAAQ,UACrB,MAAOA,EAAQ,KAChB,EACQU,GAAO,eAChBD,EAAMC,CAAG,EAAI,CACX,MAAOV,EAAQ,aACf,MAAMF,EAAAX,EAAgBa,EAAQ,YAAY,IAApC,YAAAF,EAAuC,iBAC9C,EACQ,CAAC,WAAY,UAAU,EAAE,SAASY,CAAG,IAC9CD,EAAMC,CAAG,EAAI,CACX,MAAOC,EAAWX,EAAQU,CAAG,EAAGE,CAAiB,EACjD,QAAS,GAAGC,EAAQb,EAAQU,CAAG,CAAC,CAAC,CAClC,EAET,GACWD,CACX,EACA,CAAC"}