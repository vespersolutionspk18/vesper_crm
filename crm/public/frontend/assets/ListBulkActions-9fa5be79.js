import{a3 as A,b as a,c as y,L as k,e as m,t as E,u as t,g,C as U,Y,l as V,k as C,i as S,M as R,N as M,n as j,p as te,ap as Z,F as B,f as G,O as se,w as T,G as N,_ as oe,d as L,H as ie,aF as ue,W as ce,y as de,j as me,a0 as pe,m as J,h as le,x as fe,a as ne,r as ee,I as F,B as H,aB as q,v as ge}from"./index-9a3d44ca.js";import{u as ye}from"./Dropdown-d1bc143c.js";import{_ as we,g as ve}from"./global-005ed632.js";import{a as he,_ as _e,T as be}from"./Link-b1fdcf99.js";import{D as ke}from"./NestedPopover-767b5999.js";import{_ as xe}from"./AssignmentModal-b9aa1b53.js";import{r as $e,g as I}from"./index-23e032df.js";const Ce={class:"flex h-full w-full flex-col items-center justify-center text-base"},Re={class:"text-xl font-medium"},Ve={class:"mt-1 text-base text-gray-600"},Se={__name:"ListEmptyState",setup(s){const l=A("list");return(e,r)=>(a(),y("div",Ce,[k(e.$slots,"default",{},()=>[m("div",Re,E(t(l).options.emptyState.title),1),m("div",Ve,E(t(l).options.emptyState.description),1),t(l).options.emptyState.button?(a(),g(Y,U({key:0},t(l).options.emptyState.button,{class:"mt-4"}),null,16)):V("",!0)])]))}};function ae(s,l=!0){let e=l?"14px ":"",r=s.map(n=>{let i=n.width||1;return typeof i=="number"?i+"fr":i}).join(" ");return e+r}const Q={left:"justify-start",start:"justify-start",center:"justify-center",middle:"justify-center",right:"justify-end",end:"justify-end"},Ae={class:"truncate"},Le={__name:"ListHeaderItem",props:{item:{type:Object,required:!0},debounce:{type:Number,default:1e3}},emits:["columnWidthUpdated"],setup(s,{emit:l}){const e=s,r=l,n=C(null),i=C(null),h=S(()=>{if(typeof e.item.width=="string"){const b=parseInt(e.item.width);if(e.item.width.includes("rem"))return b*16;if(e.item.width.includes("px"))return b}return i.value.offsetWidth}),c=b=>{const x=b.clientX,p=h.value,w=z=>{document.body.classList.add("select-none"),document.body.classList.add("cursor-col-resize"),n.value.style.backgroundColor="rgb(199 199 199)";let O=p+(z.clientX-x);e.item.width=`${O<50?50:O}px`,_(e.item.width)},v=()=>{document.body.classList.remove("select-none"),document.body.classList.remove("cursor-col-resize"),n.value.style.backgroundColor="",window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",v)};window.addEventListener("mousemove",w),window.addEventListener("mouseup",v)},_=ye(b=>{e.item.width=b,r("columnWidthUpdated")},e.debounce),$=A("list");return(b,x)=>(a(),y("div",{ref_key:"columnRef",ref:i,class:j(["group flex items-center",s.item.align?t(Q)[s.item.align]:"justify-between"])},[m("div",{class:j(["flex items-center space-x-2 truncate text-sm text-gray-600",b.$attrs.class])},[k(b.$slots,"prefix",R(M({item:s.item}))),k(b.$slots,"default",{},()=>[m("div",Ae,E(s.item.label),1)]),k(b.$slots,"suffix",R(M({item:s.item})))],2),t($).options.resizeColumn?k(b.$slots,"resizer",R(U({key:0},{item:s.item})),()=>[m("div",{class:"flex h-4 w-2 cursor-col-resize justify-center",onMousedown:c},[m("div",{ref_key:"resizer",ref:n,class:"h-full w-[2px] rounded-full transition-all duration-300 ease-in-out group-hover:bg-gray-400"},null,512)],32)]):V("",!0)],2))}},je={__name:"ListHeader",emits:["columnWidthUpdated"],setup(s,{emit:l}){const e=l,r=A("list");return(n,i)=>(a(),y("div",{class:"mb-2 grid items-center space-x-4 rounded bg-gray-100 p-2",style:se({gridTemplateColumns:t(ae)(t(r).columns,t(r).options.selectable)})},[t(r).options.selectable?(a(),g(Z,{key:0,class:"cursor-pointer duration-300",modelValue:t(r).allRowsSelected,onClick:te(t(r).toggleAllRows,["stop"])},null,8,["modelValue","onClick"])):V("",!0),k(n.$slots,"default",{},()=>[(a(!0),y(B,null,G(t(r).columns,h=>(a(),g(Le,{key:h.key,item:h,onColumnWidthUpdated:c=>e("columnWidthUpdated",h)},null,8,["item","onColumnWidthUpdated"]))),128))])],4))}},ze={class:"truncate text-base"},De={__name:"ListRowItem",props:{column:{type:Object,default:{}},row:{type:Object,default:{}},item:{type:[String,Number,Object],default:""},align:{type:String,default:"left"}},setup(s){const l=s,e=S(()=>r(l.item).label||"");function r(i){return i&&typeof i=="object"?i:{label:i}}const n=A("list");return(i,h)=>(a(),g(N(t(n).options.showTooltip?t(we):"div"),R(M(t(n).options.showTooltip?{text:e.value}:{})),{default:T(()=>[m("div",{class:j(["flex items-center space-x-2",t(Q)[s.align]])},[k(i.$slots,"prefix",{},()=>[s.column.prefix?(a(),g(N(typeof s.column.prefix=="function"?s.column.prefix({row:s.row}):s.column.prefix),{key:0})):V("",!0)]),k(i.$slots,"default",R(M({label:e.value})),()=>{var c;return[m("div",ze,E((c=s.column)!=null&&c.getLabel?s.column.getLabel({row:s.row}):e.value),1)]}),k(i.$slots,"suffix")],2)]),_:3},16))}},Ee={key:0,class:"mx-2 h-px border-t border-gray-200"},re={__name:"ListRow",props:{row:{type:Object,required:!0}},setup(s){const l=s,e=A("list"),r=S(()=>{var i;return(i=e.value.rows)!=null&&i.length?e.value.rows[e.value.rows.length-1][e.value.rowKey]===l.row[e.value.rowKey]:!1}),n=S(()=>typeof e.value.options.rowHeight=="number"?`${e.value.options.rowHeight}px`:e.value.options.rowHeight);return(i,h)=>(a(),g(N(t(e).options.getRowRoute?"router-link":"div"),U({class:"flex cursor-pointer flex-col transition-all duration-300 ease-in-out"},{to:t(e).options.getRowRoute?t(e).options.getRowRoute(s.row):void 0,onClick:t(e).options.onRowClick?()=>t(e).options.onRowClick(s.row):void 0}),{default:T(()=>[(a(),g(N(t(e).options.getRowRoute?"template":"button"),{class:"[all:unset] hover:[all:unset]"},{default:T(()=>[m("div",{class:j(["grid items-center space-x-4 rounded px-2",t(e).selections.has(s.row[t(e).rowKey])?"bg-gray-100 hover:bg-gray-200":"hover:bg-gray-50"]),style:se({height:n.value,gridTemplateColumns:t(ae)(t(e).columns,t(e).options.selectable)})},[t(e).options.selectable?(a(),g(Z,{key:0,modelValue:t(e).selections.has(s.row[t(e).rowKey]),onClick:h[0]||(h[0]=te(c=>t(e).toggleRow(s.row[t(e).rowKey]),["stop"])),class:"cursor-pointer duration-300"},null,8,["modelValue"])):V("",!0),(a(!0),y(B,null,G(t(e).columns,(c,_)=>(a(),y("div",{key:c.key,class:j([t(Q)[c.align],_==0?"text-gray-900":"text-gray-700"])},[k(i.$slots,"default",R(M({idx:_,column:c,item:s.row[c.key]})),()=>[t(e).slots.cell?(a(),g(N(t(e).slots.cell),R(U({key:0},{column:c,row:s.row,item:s.row[c.key],align:c.align})),null,16)):(a(),g(De,{key:1,column:c,row:s.row,item:s.row[c.key],align:c.align},null,8,["column","row","item","align"]))])],2))),128))],6),r.value?V("",!0):(a(),y("div",Ee))]),_:3}))]),_:3},16))}},Me={class:"h-full overflow-y-auto"},Te={__name:"ListRows",setup(s){const l=A("list");return(e,r)=>(a(),y("div",Me,[k(e.$slots,"default",{},()=>[(a(!0),y(B,null,G(t(l).rows,n=>(a(),g(re,{key:n[t(l).rowKey],row:n},null,8,["row"]))),128))])]))}},Be={},Oe={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16"},We=m("path",{fill:"currentColor",d:"M4.293 5.28h7.413a.5.5 0 0 1 .41.787l-3.707 5.295a.5.5 0 0 1-.82 0L3.884 6.067a.5.5 0 0 1 .41-.787Z"},null,-1),He=[We];function Ne(s,l){return a(),y("svg",Oe,He)}const Ue=oe(Be,[["render",Ne]]),Ke={class:"flex items-center"},Fe={class:"w-full py-1.5 pr-2"},Ge={key:1,class:"text-base font-medium leading-6"},qe=m("div",{class:"mx-2 h-px border-t border-gray-200"},null,-1),Ie={__name:"ListGroupHeader",props:{group:{type:Object,required:!0}},setup(s){const l=s,e=A("list");function r(){l.group.collapsed==null&&(l.group.collapsed=!1),l.group.collapsed=!l.group.collapsed}return(n,i)=>(a(),y(B,null,[m("div",Ke,[m("button",{onClick:r,class:"ml-[3px] mr-[11px] rounded p-1 hover:bg-gray-100"},[L(Ue,{class:j(["h-4 w-4 text-gray-900 transition-transform duration-200",[s.group.collapsed?"-rotate-90":""]])},null,8,["class"])]),k(n.$slots,"default",{},()=>[m("div",Fe,[t(e).slots["group-header"]?(a(),g(N(t(e).slots["group-header"]),R(U({key:0},{group:s.group})),null,16)):(a(),y("span",Ge,E(s.group.group),1))])])]),qe],64))}},Pe={key:0,class:"mb-5 mt-2"},Xe={__name:"ListGroupRows",props:{group:{type:Object,required:!0}},setup(s){const l=A("list");return(e,r)=>s.group.collapsed?V("",!0):(a(),y("div",Pe,[k(e.$slots,"default",{},()=>[(a(!0),y(B,null,G(s.group.rows,n=>(a(),g(re,{key:n[t(l).rowKey],row:n},null,8,["row"]))),128))])]))}},Ye={class:"h-full overflow-y-auto"},Je={__name:"ListGroups",setup(s){const l=A("list");return(e,r)=>(a(),y("div",Ye,[(a(!0),y(B,null,G(t(l).rows,n=>(a(),y("div",{key:n.group},[k(e.$slots,"default",{},()=>[L(Ie,{group:n},{default:T(()=>[e.$slots["group-header"]?k(e.$slots,"group-header",R(U({key:0},{group:n}))):V("",!0)]),_:2},1032,["group"]),L(Xe,{group:n},null,8,["group"])])]))),128))]))}},Ze={key:0,class:"absolute inset-x-0 bottom-6 mx-auto w-max text-base"},Qe={class:"flex flex-1 justify-between border-r border-gray-300 text-gray-900"},et={class:"flex items-center space-x-3"},tt={class:"mr-3"},st={class:"flex items-center space-x-1"},ot=Object.assign({inheritAttrs:!1},{__name:"ListSelectBanner",setup(s){const l=A("list");let e=S(()=>{let r=l.value.selections.size===1?"Row":"Rows";return`${l.value.selections.size} ${r} selected`});return(r,n)=>(a(),g(ue,{"enter-active-class":"duration-300 ease-out","enter-from-class":"transform opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-300 ease-in","leave-from-class":"opacity-100","leave-to-class":"transform opacity-0"},{default:T(()=>[t(l).selections.size?(a(),y("div",Ze,[m("div",{class:j(["flex min-w-[596px] items-center space-x-3 rounded-lg bg-white px-4 py-2 shadow-2xl",r.$attrs.class])},[k(r.$slots,"default",R(M({selections:t(l).selections,allRowsSelected:t(l).allRowsSelected,selectAll:()=>t(l).toggleAllRows(!0),unselectAll:()=>t(l).toggleAllRows(!1)})),()=>[m("div",Qe,[m("div",et,[L(Z,{modelValue:!0,disabled:!0,class:"text-gray-900"}),m("div",null,E(t(e)),1)]),m("div",tt,[k(r.$slots,"actions",R(M({selections:t(l).selections,allRowsSelected:t(l).allRowsSelected,selectAll:()=>t(l).toggleAllRows(!0),unselectAll:()=>t(l).toggleAllRows(!1)})))])]),m("div",st,[L(Y,{class:j(["w- text-gray-700",t(l).allRowsSelected?"cursor-not-allowed":""]),disabled:t(l).allRowsSelected,variant:"ghost",onClick:n[0]||(n[0]=i=>t(l).toggleAllRows(!0))},{default:T(()=>[ie(" Select all ")]),_:1},8,["disabled","class"]),L(Y,{icon:"x",variant:"ghost",onClick:n[1]||(n[1]=i=>t(l).toggleAllRows(!1))})])])],2)])):V("",!0)]),_:3}))}}),lt={class:"relative flex w-full flex-1 flex-col overflow-x-auto"},bt=Object.assign({inheritAttrs:!1},{__name:"ListView",props:{columns:{type:Array,default:[]},rows:{type:Array,default:[]},rowKey:{type:String,required:!0},options:{type:Object,default:()=>({getRowRoute:null,onRowClick:null,showTooltip:!0,selectable:!0,resizeColumn:!1,rowHeight:40,emptyState:{title:"No Data",description:"No data available"}})}},emits:["update:selections"],setup(s,{emit:l}){const e=s,r=ce();let n=de(new Set);const i=l;me(n,p=>{i("update:selections",p)});let h=S(()=>{function p(v){return v===void 0?!0:v}function w(v){return v===void 0?!1:v}return{getRowRoute:e.options.getRowRoute||null,onRowClick:e.options.onRowClick||null,showTooltip:p(e.options.showTooltip),selectable:p(e.options.selectable),resizeColumn:w(e.options.resizeColumn),rowHeight:e.options.rowHeight||40,emptyState:e.options.emptyState}});const c=S(()=>e.rows.length?$.value?n.size===e.rows.reduce((p,w)=>p+w.rows.length,0):n.size===e.rows.length:!1),_=S(()=>h.value.selectable);let $=S(()=>e.rows.every(p=>p.group&&p.rows&&Array.isArray(p.rows)));function b(p){n.delete(p)||n.add(p)}function x(p){if(!p||c.value){n.clear();return}if($.value){e.rows.forEach(w=>{w.rows.forEach(v=>n.add(v[e.rowKey]))});return}e.rows.forEach(w=>n.add(w[e.rowKey]))}return pe("list",S(()=>({rowKey:e.rowKey,rows:e.rows,columns:e.columns,options:h.value,selections:n,allRowsSelected:c.value,slots:r,toggleRow:b,toggleAllRows:x}))),(p,w)=>(a(),y("div",lt,[m("div",{class:j(["flex w-max min-w-full flex-col overflow-y-hidden",p.$attrs.class])},[k(p.$slots,"default",R(M({showGroupedRows:t($),selectable:_.value})),()=>[L(je),e.rows.length?(a(),y(B,{key:0},[t($)?(a(),g(Je,{key:0})):(a(),g(Te,{key:1}))],64)):(a(),g(Se,{key:1})),_.value?(a(),g(ot,{key:2})):V("",!0)])],2)]))}}),nt={},at={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"fillCurrent",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-heart"},rt=m("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"},null,-1),it=[rt];function ut(s,l){return a(),y("svg",at,it)}const kt=oe(nt,[["render",ut]]),ct={class:"mb-4"},dt={class:"mb-1.5 text-sm text-gray-600"},mt={class:"mb-1.5 text-sm text-gray-600"},pt={__name:"EditValueModal",props:J({doctype:{type:String,required:!0},selectedValues:{type:Set,required:!0}},{modelValue:{},modelModifiers:{}}),emits:J(["reload"],["update:modelValue"]),setup(s,{emit:l}){const e=["Check"],r=["Link","Dynamic Link"],n=["Float","Int","Currency","Percent"],i=["Select"],h=["Text Editor"],c=["Date","Datetime"],_=s,$=le(s,"modelValue"),b=l,x=fe({url:"crm.api.doc.get_fields",cache:["fields",_.doctype],params:{doctype:_.doctype},transform:o=>o.filter(d=>d.hidden==0&&d.read_only==0)});ne(()=>{var o;(o=x.data)!=null&&o.length||x.fetch()});const p=S(()=>{var o;return((o=_.selectedValues)==null?void 0:o.size)||0}),w=C({label:"",type:"",value:"",options:""}),v=C(""),z=C(!1);function O(){let o=v.value;w.value.type=="Check"&&(o=o=="Yes"?1:0),z.value=!0,F("frappe.desk.doctype.bulk_update.bulk_update.submit_cancel_or_update_docs",{doctype:_.doctype,docnames:Array.from(_.selectedValues),action:"update",data:{[w.value.value]:o||null}}).then(()=>{w.value={label:"",type:"",value:"",options:""},v.value="",z.value=!1,$.value=!1,b("reload")})}function P(o){v.value="",o&&(w.value=o)}function K(o){let d=o.target?o.target.value:o;v.value=d}function f(o){return o.split(`
`)}function u(o){const{type:d,options:W}=o;if(i.includes(d)||e.includes(d)){const X=d=="Check"?["Yes","No"]:f(W);return H(q,{type:"select",options:X.map(D=>({label:D,value:D})),modelValue:v.value})}else return r.includes(d)?d=="Dynamic Link"?H(q,{type:"text"}):H(_e,{class:"form-control",doctype:W}):n.includes(d)?H(q,{type:"number"}):c.includes(d)?H(ke):h.includes(d)?H(be,{variant:"outline",editorClass:"!prose-sm overflow-auto min-h-[80px] max-h-80 py-1.5 px-2 rounded border border-gray-300 bg-white hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400 text-gray-800 transition-colors",bubbleMenu:!0,content:v.value}):H(q,{type:"text"})}return(o,d)=>{const W=ee("Button"),X=ee("Dialog");return a(),g(X,{modelValue:$.value,"onUpdate:modelValue":d[2]||(d[2]=D=>$.value=D),options:{title:o.__("Bulk Edit")}},{"body-content":T(()=>[m("div",ct,[m("div",dt,E(o.__("Field")),1),L(he,{value:w.value.label,options:t(x).data,onChange:d[0]||(d[0]=D=>P(D)),placeholder:o.__("Source")},null,8,["value","options","placeholder"])]),m("div",null,[m("div",mt,E(o.__("Value")),1),(a(),g(N(u(w.value)),{value:v.value,size:"md",onChange:d[1]||(d[1]=D=>K(D)),placeholder:o.__("Contact Us")},null,40,["value","placeholder"]))])]),actions:T(()=>[L(W,{class:"w-full",variant:"solid",onClick:O,loading:z.value,label:o.__("Update {0} Records",[p.value])},null,8,["loading","label"])]),_:1},8,["modelValue","options"])}}},xt={__name:"ListBulkActions",props:J({doctype:{type:String,default:""},options:{type:Object,default:()=>({hideEdit:!1,hideDelete:!1,hideAssign:!1})}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s,{expose:l}){const e=s,r=le(s,"modelValue"),n=ge(),{$dialog:i}=ve(),h=C(!1),c=C([]),_=C(()=>{});function $(f,u){c.value=f,h.value=!0,_.value=u}function b(f,u){i({title:__("Delete"),message:__("Are you sure you want to delete {0} item(s)?",[f.size]),variant:"solid",theme:"red",actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:o=>{F("frappe.desk.reportview.delete_items",{items:JSON.stringify(Array.from(f)),doctype:e.doctype}).then(()=>{I({title:__("Deleted successfully"),icon:"check",iconClasses:"text-green-600"}),u(),r.value.reload(),o()})}}]})}const x=C(!1),p=C([]);function w(f,u){x.value=!0,c.value=f,_.value=u}function v(f,u){i({title:__("Clear Assignment"),message:__("Are you sure you want to clear assignment for {0} item(s)?",[f.size]),variant:"solid",theme:"red",actions:[{label:__("Clear Assignment"),variant:"solid",theme:"red",onClick:o=>{F("frappe.desk.form.assign_to.remove_multiple",{doctype:e.doctype,names:JSON.stringify(Array.from(f)),ignore_permissions:!0}).then(()=>{I({title:__("Assignment cleared successfully"),icon:"check",iconClasses:"text-green-600"}),K(u),o()})}}]})}const z=C([]),O=C([]);function P(f,u){let o=[];return e.options.hideEdit||o.push({label:__("Edit"),onClick:()=>$(f,u)}),e.options.hideDelete||o.push({label:__("Delete"),onClick:()=>b(f,u)}),e.options.hideAssign||(o.push({label:__("Assign To"),onClick:()=>w(f,u)}),o.push({label:__("Clear Assignment"),onClick:()=>v(f,u)})),z.value.forEach(d=>{o.push({label:__(d.label),onClick:()=>d.onClick({list:r.value,selections:f,unselectAll:u,call:F,createToast:I,$dialog:i,router:n})})}),o}function K(f){var u,o;(u=_.value)==null||u.call(_),f==null||f(),(o=r.value)==null||o.reload()}return ne(()=>{var f,u,o,d,W;(f=r.value)!=null&&f.data&&($e(r.value.data,{list:r.value,call:F,createToast:I,$dialog:i,router:n}),z.value=((o=(u=r.value)==null?void 0:u.data)==null?void 0:o.bulkActions)||[],O.value=((W=(d=r.value)==null?void 0:d.data)==null?void 0:W.listActions)||[])}),l({bulkActions:P,customListActions:O}),(f,u)=>(a(),y(B,null,[h.value?(a(),g(pt,{key:0,modelValue:h.value,"onUpdate:modelValue":u[0]||(u[0]=o=>h.value=o),doctype:s.doctype,selectedValues:c.value,onReload:K},null,8,["modelValue","doctype","selectedValues"])):V("",!0),x.value?(a(),g(xe,{key:1,modelValue:x.value,"onUpdate:modelValue":u[1]||(u[1]=o=>x.value=o),assignees:p.value,"onUpdate:assignees":u[2]||(u[2]=o=>p.value=o),docs:c.value,doctype:s.doctype,onReload:K},null,8,["modelValue","assignees","docs","doctype"])):V("",!0)],64))}};export{kt as H,je as _,Le as a,De as b,ot as c,bt as d,xt as e,Te as f,re as g,Ie as h,Xe as i};
//# sourceMappingURL=ListBulkActions-9fa5be79.js.map
